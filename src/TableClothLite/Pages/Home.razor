@page "/"
@inject SandboxViewModel Model

<PageTitle>식탁보 라이트 Preview</PageTitle>


<div>
	<h1>식탁보 라이트 Preview</h1>
	<p>설치하지 않고 사용하는 식탁보를 경험해보세요. Windows Sandbox만 설치되어있으면 인터넷 뱅킹 환경을 곧바로 격리된 경량 가상 PC에서 분리해서 실행할 수 있습니다.</p>
	<p><strong>식탁보 라이트로 가상 환경을 사용하려면 Windows Sandbox가 반드시 설치되어 있어야 합니다. (<a href="https://yourtablecloth.app/howto_install_sandbox" target="_blank">설치 방법 보기</a>)</strong></p>
</div>

<p>&nbsp;</p>

<div>
	@if (Model.Services.Any())
	{
		<FluentAccordion>
			@foreach (var eachGroup in Model.Services.GroupBy(x => x.Category.Trim().ToLowerInvariant()))
			{
				<FluentAccordionItem Heading="@Model.DisplayCategoryName(eachGroup.Key)" Expanded="true">
					<FluentGrid Justify="JustifyContent.FlexStart" Spacing="2" AdaptiveRendering="true">
						@foreach (var eachService in eachGroup)
						{
							<FluentGridItem xs="6" sm="3" Justify="JustifyContent.Center">
								<FluentCard>
									<FluentIcon Value="@(Icon.FromImageUrl(Model.CalculateAbsoluteUrl(eachService.ImageRelativePath)))" />
									<span>@eachService.DisplayName</span>
									<br /><br />
									<div style="text-align: right;">
										<FluentButton style="cursor: pointer;" Appearance="Appearance.Neutral" @onclick="() => Model.GenerateSandboxDocumentAsync(eachService)">
											<FluentEmoji Value="@(new Emojis.Symbols.Color.Default.PlayButton())" />
										</FluentButton>
									</div>
								</FluentCard>
							</FluentGridItem>
						}
					</FluentGrid>
				</FluentAccordionItem>
			}
		</FluentAccordion>
	}
	else
	{
		<p>불러오는 중입니다...</p>
	}
</div>

<p>&nbsp;</p>

<div>
	&copy; 2025 rkttu.com, All rights reserved.
</div>

@code {
	protected override void OnInitialized()
	{
		// 비동기로 하면 화면 상호작용이 막히기 때문에 OnInitializedAsync 방식에서 변경
		Model.LoadCatalogCommand.ExecuteAsync(this)
			.ContinueWith(async (task) => await InvokeAsync(StateHasChanged));
	}
}